# hackathon-kod-pobedy

Код проекта Pobedaletters. Сайт: pobedaletters.ru
Осбенности проекта:
- **БЕЗ API**. Абсолютно все работает локально  
- Сайт поддерживает 11 яызков. Пайплайн генерации более 100 языков
- Поддержка пользователей через telegram бот
- Выбор диктора времен ВОВ
- Полное покрытие автотестами
- Очередь запросов
- Микросервисная архитектура
- Тестировка API через postman

Осбенности генерации фильма по письму:
- Генерация обложки
- Генерация субтитров
- Фоновая музыка
- Интерполяция видео (Генерация в 32 FPS)
# Telegram bot

Телеграм бот для технической поддержки сайта. Рабочий бот: @pobedaletters_supportbot

## Установка

1. Установите зависимости:
```bash
pip install -r telegram_bot/requirements.txt
```

2. Создайте файл `.env` и добавьте следующие переменные:
```
BOT_TOKEN=ваш_токен
SUPPORT_CHAT_ID=id_группы
```

## Настройка

1. Получите токен бота у [@BotFather](https://t.me/BotFather) в Telegram
2. Создайте группу для поддержки и добавьте туда бота
3. Получите ID группы поддержки
4. Замените значения в файле `.env`

## Запуск

```bash
python telegram_bot/main.py
```

## Функциональность

- `/start` - Начало работы с ботом
- `/help` - Получение справки
- `/faq` - список частозадаваемых вопросов
- Любое текстовое сообщение будет отправлено команде поддержки

## Структура проекта

- `main.py` - Основной файл бота
- `faq.py` - файл с частозадаваемыми вопросами
- `requirements.txt` - Зависимости проекта
- `.env` - Конфигурационный файл (нужно создать) 


# Backend

## Проверка API
1. Бэкэнд работает на нашем сервере, вы уже можете его протестировать.
2. В папке postman_api лежит json файл примеров запросам к API.
3. Его нужно импортировать в Postman, это позволит вам протестировать API.

Далее следуют инструкции, для локального запуска. Для запуска вам надо будет установить PostgreSQL на сервер.

## Установка

1. Установите зависимости:
```bash
pip install -r backend/requirements.txt
```

2. Чтобы модель Text-To-Speech работала нужно скачать веса

```bash
huggingface-cli download "TVI/f5-tts-ru-accent" --local-dir "backend\api\modules\f5_ckpt"
```
3. Для интерполяции видео мы используем RIFE

```bash
git clone git@github.com:megvii-research/ECCV2022-RIFE.git"
```


## Запуск
```bash
.\.venv312\Scripts\activate
cd backend
python manage.py runserver 0.0.0.0:8000
```

## Структура проекта

- `modules` - Каталог основных модулей
- `modules/speakers` - Сэмплы дикторов
- `modules/songs` - Фоновая музыка
- `modules/llm_module.py` - Модуль с LLM
- `modules/main_service.py` - Главный модуль, с главным методом генерации
- `modules/music_module.py` - Модуль подбора и обрезки музыки
- `modules/norm_module.py` - Модуль нормализации письма
- `modules/stt_module.py` - Модуль создания субтитров
- `modules/tts_module.py` - Модуль озвучки письма
- `modules/text2image_module.py` - Модуль создания обложки видео
- `modules/text2video_module.py` - Модуль создания кадров видео
- `views.py` - REST API и обработка запросов, очередь запросов
- `tests.py` - Автотесты
- `models.py` - Data-классы таблиц из бд
- `serializers.py` - Сериализаторы